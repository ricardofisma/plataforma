<script type="text/javascript" src="jsxgraphcore.js"></script>
<link rel="stylesheet" href="jsxgraph.css">

<style>
   #box {
      width: 300px;
      height: 400px
   }

   #box2 {
      width: 200px;
      height: 100px
   }

   #box3 {
      width: 100px;
      height: 200px
   }
</style>





<div id="box" class="jxgbox"></div>
<div id="box2" class="jxgbox"></div>
<div id="box3" class="jxgbox"></div>
<input type="button" value="Animate On/Off" id="ani" />
<input type="button" value="Clear Traces" id="clearTr" />




<script>
   var board = JXG.JSXGraph.initBoard('box', {
      boundingbox: [-5, 5, 4, -5],
      axis: true,
      showCopyright: false,
      showNavigation: false
   });
   var board2 = JXG.JSXGraph.initBoard('box2', {
      boundingbox: [-4, 1.5, 4, -1.5],
      axis: true,
      showCopyright: false,
      showNavigation: false
   });
   var board3 = JXG.JSXGraph.initBoard('box3', {
      boundingbox: [-1.5, 6, 1.5, -5],
      axis: true,
      showCopyright: false,
      showNavigation: false
   });

   var f = function (x) {
      if (x >= -3 && x <= -1) {
         return (x + 3) * (x + 3);
      } else if (x > -1 && x < 3) {
         return -3 / 2 * (x - 5 / 3);
      }
   };

   pwgraph = board.create('functiongraph', [f, -3, 3], {
      strokeColor: '#000000'
   });
   var ep1 = board.create('point', [-3, 0], {
      strokeColor: '#000000',
      fillColor: '#000000',
      name: '',
      fixed: true
   });
   var ep2 = board.create('point', [-1, 4], {
      strokeColor: '#000000',
      fillColor: '#000000',
      name: '',
      fixed: true
   });
   var ep3 = board.create('point', [3, -2], {
      strokeColor: '#000000',
      fillColor: '#000000',
      name: '',
      fixed: true
   });


   var s = board.create('slider', [
      [-4.5, -4],
      [-1, -4],
      [-3, -3, 3]
   ]);
   var tracepoint = board.create('point', [function () {
      return s.Value();
   }, function () {
      return f(s.Value());
   }], {
      name: ''
   });
   // domain:
   var b2p1 = board2.create('point', [function () {
      return tracepoint.X()
   }, 0], {
      fixed: true,
      trace: true,
      strokeColor: '#ff0000',
      name: 'D'
   });
   // range:
   var b2p2 = board3.create('point', [
      0,
      function () {
         return tracepoint.Y();
      }
   ], {
      fixed: true,
      trace: true,
      strokeColor: '#0000ff',
      fillColor: '#0000ff',
      name: 'R'
   });

   board.addChild(board2);
   board.addChild(board3);

   function clearTraces() {
      b2p1.clearTrace();
      b2p2.clearTrace();
   }
   // Animation
   var animated = false;

   function animate(point, direction, count) {
      if (animated) {
         point.stopAnimation();
         animated = false;
      } else {
         point.startAnimation(direction, count);
         animated = true;
      }
   }

   document.onkeydown = checkKey;

   function checkKey(e) {
      e = e || window.event;
      if (animated == false) {
         if (e.keyCode == '37') {
            s.moveTo([s.X() - 0.1, 0], 0);
         } else if (e.keyCode == '39') {
            s.moveTo([s.X() + 0.1, 0], 0);
         }
      }
   }
   document.getElementById("ani").addEventListener("click", function () {
      animate(s, 75, 100);
   });
   document.getElementById("clearTr").addEventListener("click", function () {
      clearTraces();
   });
</script>